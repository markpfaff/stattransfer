<!-- saved from url=(0014)about:internet -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><TITLE>Excel Worksheets</TITLE><meta name="generator" content="FastHelp Multi-User"><meta name="keywords" content="">

<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
#FHNonScroll
{padding: 6px 6px 0px 6px; border-bottom: none; background: #6699FF; vertical-align: top;z-index: 2; visibility: visible; position: absolute; left: 0; top: 0; width: 100%!important; line-height: 0; font-size: 0; overflow:hidden; }
#FHNonScroll > table {padding: 6px;}
#MainSection {overflow: hidden; }
#FHScroll
{left: 0; top: 0px; position: absolute; margin: 0; padding: 10px; z-index: 1; background-repeat: no-repeat; background-position: bottom right; background-attachment: fixed; }





/* ========== Text Styles ========== */
hr { color: #000000}
body, table /* Normal */
{
 font-size: 10pt;
 font-family: 'Arial';
 font-style: normal;
 font-weight: normal;
 color: #000000;
 text-decoration: none;
 ;
}
span.rvts1
{
 font-family: 'Arial Unicode MS';
}
span.rvts2
{
 font-size: 11pt;
 font-family: 'Verdana';
 color: #000000;
}
span.rvts3
{
 font-size: 11pt;
 font-family: 'Verdana';
 font-weight: bold;
 color: #000000;
}
span.rvts4
{
 font-size: 11pt;
 font-family: 'Verdana';
}
span.rvts5
{
 font-size: 11pt;
 font-family: 'Verdana';
 font-style: italic;
 color: #000000;
}
span.rvts6
{
 font-size: 11pt;
 font-family: 'Verdana';
 font-style: italic;
 font-weight: bold;
 color: #000000;
}
span.rvts7
{
 font-size: 11pt;
 font-family: 'Verdana';
 font-style: italic;
 color: #000000;
 text-decoration: underline;
}
span.rvts8
{
 font-size: 11pt;
 font-family: 'Verdana';
 color: #000000;
 background-color: #ffff99;
}
/* ========== Para Styles ========== */
p,ul,ol /* Left */
{
 text-align: left;
 text-indent: 0px;
 padding: 0px 0px 0px 0px;
 margin: 0px 0px 0px 0px;
}
.rvps1
{
}
--></style>
<script type="text/javascript" language="JavaScript" src="FHUtilities.js"></script>
<script src="FHSearchHighlight.js"></script>
<script src="FHSearchHighlight2.js"></script>
<!-- If this page is displayed outside of the Website Help Frameset, then reload in the Frame set -->
<script>if (parent.location == self.location)
{location.href = "index.html?"+extractFileNameWithoutKnownExtension(location.href);}
</script>
<script type="text/javascript" language="JavaScript" src="FHNonscroll.js"></script><script type="text/javascript" language="JavaScript" src="FHUtilities.js"></script><script type="text/javascript" language="JavaScript" src="FHFlyoverPopups.js"></script><link rel="stylesheet" type="text/css" href="FHFlyoverPopupStyle.css" /></HEAD>
<body bgcolor="#FFFFFF" scroll="no" id="MainSection"><div id="FHNonScroll"><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td width="100%" align="left">
<font size=2 color="#000000" face="Arial">
<div><font size=4 color="#333399" face="Verdana"><b>Excel Worksheets</b></font></div>
</font>
</td><td width="120" align="right" nowrap><font face="Verdana" size="2"><a href="hs157.html"><img src="Images/BrowseBlueLeft.png" border="0" alt="Previous Topic"></a>&nbsp;&nbsp;<a href="hs115.html"><img src="Images/BrowseBlueRight.png" border="0" alt="Next Topic"></a>&nbsp;</font></td></tr></table></div><div id="FHScroll"><div id="width_height"></div>

<p class=rvps1><span class=rvts2>Stat/Transfer will read and write files from Excel.&nbsp; It will read all versions and will write Version 2.1 files and files for Excel 97 and higher versions. Note that Excel 97 and higher versions support long strings (up to 32K) and more (up to 64K) records in a worksheet.</span></p>
<p class=rvps1><span class=rvts2><br></span></p>
<p class=rvps1><span class=rvts2>Excel 2007 has vastly increased limits over earlier versions. The maximum number of columns has been increased from 256 to 65,536 and the maximum number of rows has increased from 16,384 to over one million. Note however, this does not mean that Excel is an appropriate tool for very large datasets. You will find that the time to load very large files is agonizingly slow.</span></p>
<p class=rvps1><span class=rvts2><br></span></p>
<p class=rvps1><span class=rvts4>Excel 2013 has added a new “Strict Open XML” format.&nbsp;&nbsp; Stat/Transfer also will read this format.</span></p>
<p class=rvps1><span class=rvts8><br></span></p>
<p class=rvps1><span class=rvts6>Standard extension: </span><span class=rvts5> </span><span class=rvts3>xls</span></p>
<p class=rvps1><span class=rvts3><br></span></p>
<p class=rvps1><span class=rvts3>Reading Excel Worksheet Files</span></p>
<p class=rvps1><span class=rvts2>Because worksheet files are in general not designed to hold statistical data, only worksheets in certain formats can be read.</span></p>
<p class=rvps1><span class=rvts2><br></span></p>
<p class=rvps1><span class=rvts2>Worksheets must be in worksheet database format or in certain modifications of this.&nbsp; It is most straightforward to read worksheets in database format.</span></p>
<p class=rvps1><span class=rvts2><br></span></p>
<p class=rvps1><span class=rvts7>Database Format</span></p>
<p class=rvps1><span class=rvts2>Worksheet database files are structured worksheets where each row is a single case and each column contains a variable.&nbsp; Data can consist of numbers (including serial date numbers), labels, or formulas.</span></p>
<p class=rvps1><span class=rvts2><br></span></p>
<p class=rvps1><span class=rvts2>The first non-blank row of a worksheet database file usually has strings in each column that give the names of the variables.&nbsp; The data then begins in the next row. However, variable names may be in different rows or not present at all.</span></p>
<p class=rvps1><span class=rvts2><br></span></p>
<p class=rvps1><span class=rvts2>You have several options to specify what part of an input worksheet to read and how to read variable names.&nbsp; An option allows you to read variable labels from the row after the variable names.&nbsp; </span></p>
<p class=rvps1><span class=rvts2><br></span></p>
<p class=rvps1><span class=rvts7>Data Range</span></p>
<p class=rvps1><span class=rvts2>You can choose different ranges to be read in input worksheets by using the drop-down menu for </span><span class=rvts3>Data Range </span><span class=rvts2>in the </span><span class=rvts3>Worksheets</span><span class=rvts2> section of the </span><span class=rvts3>Options </span><span class=rvts2>dialog box or using the SET command, WKS-DATA-RANGE.</span></p>
<p class=rvps1><span class=rvts2><br></span></p>
<p class=rvps1><span class=rvts2>If you use </span><span class=rvts3>Autosense </span><span class=rvts2>(the default), Stat/Transfer will read to the first non-blank cell and use that as the upper left corner of the data range.&nbsp; It will then read data until it encounters an entirely blank line.&nbsp; This is the default behavior.&nbsp; You can change the behavior with respect to blank rows by using the </span><span class=rvts3>Blank Rows </span><span class=rvts2>option.</span></p>
<p class=rvps1><span class=rvts2><br></span></p>
<p class=rvps1><span class=rvts2>Rather than have Stat/Transfer automatically sense the number of rows to be read, you can use the other options for </span><span class=rvts3>Data Range </span><span class=rvts2>to specify a range, either by giving a named range or by giving explicit coordinates. </span></p>
<p class=rvps1><span class=rvts2><br></span></p>
<p class=rvps1><span class=rvts2>When a range has been specified, Stat/Transfer's treatment of entirely blank rows will also be overridden.&nbsp; They will be returned in your output data and, in addition, blank rows at the end of the worksheet, through the last row of the specified range, will also be returned.</span></p>
<p class=rvps1><span class=rvts2><br></span></p>
<p class=rvps1><span class=rvts7>Determining Variable Names</span></p>
<p class=rvps1><span class=rvts2>By default, Stat/Transfer will attempt to determine whether or not the data in the first non-blank row (or the first row of a specified range) are variable names or the first row of data.&nbsp; It does so by looking for at least one column in which there is a string in the first row and a number in the second.&nbsp; If this behavior is inappropriate for your worksheet (for example, if you have only string data), you can specify different options in the </span><span class=rvts3>Field Name Row </span><span class=rvts2>drop-down menu of the </span><span class=rvts3>Worksheets</span><span class=rvts2> section of the </span><span class=rvts3>Options </span><span class=rvts2>dialog box.&nbsp; You can specify that variable names must be taken from the first non-blank row, that they be taken from a specific row or that the worksheet does not contain variable names, so that Stat/Transfer should assign them ('col1' through 'col</span><span class=rvts5>n</span><span class=rvts2>').</span></p>
<p class=rvps1><span class=rvts2><br></span></p>
<p class=rvps1><span class=rvts7>Determining the Data Types and Widths</span></p>
<p class=rvps1><span class=rvts2>After identifying the label row, Stat/Transfer will look at the entire column. If any cell contains a string, the entire column will be treated as string data (with numbers and dates converted to strings).&nbsp; If the column is all numeric or blank, it will be treated as a numeric column. </span></p>
<p class=rvps1><span class=rvts2><br></span></p>
<p class=rvps1><span class=rvts2>The width of the column for each numeric variable and the format of the first non-blank data cell in that column are used, where possible, to set the default target, or output, types for the numeric variables.&nbsp; If the format of the first data row has any decimal places (for example, F(2)), the target type will be 'float'.&nbsp; On the other hand, if the cell format has no decimal places (for example, F(0)) the target types will be various flavors of integers which depend on the column width.&nbsp; If the column width is less than three, the target type will be 'byte'.&nbsp; If the column width is less than five, the target type will by 'int'.&nbsp; Otherwise the target type will be 'long'.&nbsp; Any date format in the first data row will set the target type to 'date'. </span></p>
<p class=rvps1><span class=rvts2><br></span></p>
<p class=rvps1><span class=rvts2>The maximum width of character variables is determined by examining the widths of all of the strings in a column.</span></p>
<p class=rvps1><span class=rvts2><br></span></p>
<p class=rvps1><span class=rvts2>Stat/Transfer is lenient in typing variables from worksheets.&nbsp; If it is expecting a character variable and it encounters a number it will convert it to a string.</span></p>
<p class=rvps1><span class=rvts7><br></span></p>
<p class=rvps1><span class=rvts7>Combining Multiple Input Worksheet to a Single Output File</span></p>
<p class=rvps1><span class=rvts2>The option </span><span class=rvts3>Concatenate Worksheet Pages</span><span class=rvts2>, found in the </span><span class=rvts3>Worksheets</span><span class=rvts2> section of the </span><span class=rvts3>Options </span><span class=rvts2>dialog box allows you to combine worksheet pages into a single output file.&nbsp; This option is appropriate if your worksheet contains many sheets that are identical in structure.&nbsp; These can be then be combined into a single output file of any type.</span></p>
<p class=rvps1><span class=rvts2><br></span></p>
<p class=rvps1><span class=rvts2>For example, you may have a workbook that has 50 sheets, with one sheet for each state and the same variables on each sheet.&nbsp; If you check this box, Stat/Transfer will effectively combine the sheets into one large input file, dropping the field names, if necessary, on the second and higher sheets. You will end up with the data from all of your worksheet pages in a single output file. </span></p>
<p class=rvps1><span class=rvts2><br></span></p>
<p class=rvps1><span class=rvts3>Writing Excel Worksheet Files</span></p>
<p class=rvps1><span class=rvts2>On output, Stat/Transfer will write variable labels in the first row of the worksheet.&nbsp; Data values will be placed in the second and succeeding rows.</span></p>
<p class=rvps1><span class=rvts2><br></span></p>
<p class=rvps1><span class=rvts2>Column widths and formats will be determined by the variable information available.&nbsp; Dates and character variables are straightforward.&nbsp; For numerical data, information on the width and number of decimal places of variables, where available, is used to set the column widths and formats.</span></p>
<p class=rvps1><span class=rvts2><br></span></p>
<p class=rvps1><span class=rvts3>Missing Data</span></p>
<p class=rvps1><span class=rvts2>On input, blank cells and cells containing labels consisting of a single dot are read as missing.</span></p>
<p class=rvps1><span class=rvts2><br></span></p>
<p class=rvps1><span class=rvts2>If there is a string in your worksheet, such as 'NA', that you would like to have treated as a numeric missing value, you can specify it using the </span><span class=rvts3>Numeric Missing Value </span><span class=rvts2>option in the </span><span class=rvts3>Worksheets</span><span class=rvts2> section of the </span><span class=rvts3>Options </span><span class=rvts2>dialog box.&nbsp; </span></p>
<p class=rvps1><span class=rvts2><br></span></p>
<p class=rvps1><span class=rvts2>When transferring data to worksheets from other formats, missing values will be written out to worksheets as blank cells.</span></p>
<p class=rvps1><span class=rvts2><br></span></p>
<p class=rvps1><span class=rvts3>Output Variable Types</span></p>
<p class=rvps1><span class=rvts2>The output variable type that results from each target variable type is given in the following table:</span></p>
<p class=rvps1><span class=rvts2><br></span></p>
<div class=rvps1><table border=1 cellpadding=5 cellspacing=0 style="border-width: 0px;">
<tr valign=top>
<td width=31 style="border-width : 1px; border-color: #000000; border-style: solid; border-top: none; border-right: none; border-bottom: none; border-left: none;">
<p class=rvps1><span class=rvts3><br></span></p>
</td>
<td width=134 valign=top style="border-width : 1px; border-color: #000000; border-style: solid; border-right: none; border-bottom: none;">
<p class=rvps1><span class=rvts3>Target Type</span></p>
</td>
<td width=259 valign=top style="border-width : 1px; border-color: #000000; border-style: solid; border-bottom: none;">
<p class=rvps1><span class=rvts3>Output Type</span></p>
</td>
</tr>
<tr valign=top>
<td width=31 valign=middle style="border-width : 1px; border-color: #000000; border-style: solid; border-top: none; border-right: none; border-bottom: none; border-left: none;"><br>
</td>
<td width=134 valign=top style="border-width : 1px; border-color: #000000; border-style: solid; border-right: none; border-bottom: none;">
<p class=rvps1><span class=rvts2>byte </span></p>
<p class=rvps1><span class=rvts2>int</span></p>
<p class=rvps1><span class=rvts2>long</span></p>
<p class=rvps1><span class=rvts2>float</span></p>
<p class=rvps1><span class=rvts2>double</span></p>
</td>
<td width=259 valign=top style="border-width : 1px; border-color: #000000; border-style: solid; border-bottom: none;">
<p class=rvps1><span class=rvts2>Numeric cell (formatted if information available)</span></p>
</td>
</tr>
<tr valign=top>
<td width=31 style="border-width : 1px; border-color: #000000; border-style: solid; border-top: none; border-right: none; border-bottom: none; border-left: none;"><br>
</td>
<td width=134 valign=top style="border-width : 1px; border-color: #000000; border-style: solid; border-right: none; border-bottom: none;">
<p class=rvps1><span class=rvts2>string</span></p>
</td>
<td width=259 valign=top style="border-width : 1px; border-color: #000000; border-style: solid; border-bottom: none;">
<p class=rvps1><span class=rvts2>Label</span></p>
</td>
</tr>
<tr valign=top>
<td width=31 style="border-width : 1px; border-color: #000000; border-style: solid; border-top: none; border-right: none; border-bottom: none; border-left: none;"><br>
</td>
<td width=134 valign=top style="border-width : 1px; border-color: #000000; border-style: solid; border-right: none; border-bottom: none;">
<p class=rvps1><span class=rvts2>date</span></p>
</td>
<td width=259 valign=top style="border-width : 1px; border-color: #000000; border-style: solid; border-bottom: none;">
<p class=rvps1><span class=rvts2>Serial date number (with date format)</span></p>
</td>
</tr>
<tr valign=top>
<td width=31 style="border-width : 1px; border-color: #000000; border-style: solid; border-top: none; border-right: none; border-bottom: none; border-left: none;"><br>
</td>
<td width=134 valign=top style="border-width : 1px; border-color: #000000; border-style: solid; border-right: none; border-bottom: none;">
<p class=rvps1><span class=rvts2>time</span></p>
</td>
<td width=259 valign=top style="border-width : 1px; border-color: #000000; border-style: solid; border-bottom: none;">
<p class=rvps1><span class=rvts2>Time fraction (with date format if available) </span></p>
</td>
</tr>
<tr valign=top>
<td width=31 style="border-width : 1px; border-color: #000000; border-style: solid; border-top: none; border-right: none; border-bottom: none; border-left: none;"><br>
</td>
<td width=134 valign=top style="border-width : 1px; border-color: #000000; border-style: solid; border-right: none;">
<p class=rvps1><span class=rvts2>date/time</span></p>
</td>
<td width=259 valign=top style="border-width : 1px; border-color: #000000; border-style: solid;">
<p class=rvps1><span class=rvts2>Date number + time fraction</span></p>
<p class=rvps1><span class=rvts2>(with date/time format if available)</span></p>
</td>
</tr>
</table>
</div>
<p class=rvps1><span class=rvts1></span></p>

</div></body></html><script type="text/javascript">
var getsearch_key=getParameterByName('key');
$('body').highlight(getsearch_key);
$('.highlight').css('background-color',HighlightColor);
</script>

